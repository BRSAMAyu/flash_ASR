# FlashASR 4.5: Think Fast, Type Faster.

<div align="center">

![FlashASR Icon](assets/app_icon_source.png)

**åŸºäº Aliyun Dashscope ä¸åŒ AI å¼•æ“çš„ macOS åŸç”Ÿè¯­éŸ³è½¬æ–‡å­—ç”Ÿäº§åŠ›ç¥å™¨**

[![macOS](https://img.shields.io/badge/macOS-13.0+-white?logo=apple&logoColor=black)](https://www.apple.com/macos/)
[![Swift](https://img.shields.io/badge/Swift-5.9-F05138?logo=swift&logoColor=white)](https://swift.org)
[![License](https://img.shields.io/badge/License-MIT-2ecc71)](LICENSE)
[![Version](https://img.shields.io/badge/Version-4.5.0-FF69B4)](https://github.com/BRSAMAyu/flash_ASR/releases)

[**ç«‹å³ä¸‹è½½ (v4.5.0)**](https://github.com/BRSAMAyu/flash_ASR/releases/latest/download/FlashASR-4.5.0-macos.dmg) &nbsp;Â·&nbsp; [ğŸ“– æ›´æ–°æ—¥å¿—](CHANGELOG.md) &nbsp;Â·&nbsp; [ğŸ’¬ æäº¤åé¦ˆ](https://github.com/BRSAMAyu/flash_ASR/issues)

</div>

---

## ğŸŒŸ ä¸ºä»€ä¹ˆé€‰æ‹© FlashASRï¼Ÿ

åœ¨ macOS ä¸Šï¼Œç³»ç»Ÿè‡ªå¸¦çš„å¬å†™å¾€å¾€ä¸å¤Ÿæ™ºèƒ½ï¼Œè€Œç½‘é¡µç‰ˆ ASR åˆè¿‡äºç¹çã€‚**FlashASR** å¡«è¡¥äº†è¿™ä¸€ç©ºç™½ï¼šå®ƒæ˜¯ä¸€ä¸ªå¸¸é©»èœå•æ çš„"é€æ˜"å±‚ï¼Œåœ¨ä½ è¯´è¯çš„åŒæ—¶ï¼Œåˆ©ç”¨å¤§æ¨¡å‹çš„åŠ›é‡å°†ç ´ç¢çš„å£è¯­å®æ—¶é”»é€ æˆç²¾ç¾çš„ Markdown ç¬”è®°ã€‚

### ğŸ”„ ç‹¬åˆ›ã€ŒåŒå¼•æ“ååŒã€æ¶æ„ (Dual-Engine)
FlashASR 4.5 å½»åº•è§£å†³äº† AI ç”Ÿæˆ"ç­‰å¾…æ„Ÿ"ä¸"æ·±åº¦æ„Ÿ"çš„çŸ›ç›¾ï¼š
- **MiMo Flash (ä¸»å¼•æ“)**: æ¯«ç§’çº§æµå¼å“åº”ï¼Œåƒæ‰“å­—æœºä¸€æ ·è·Ÿéšä½ çš„å£°éŸ³ã€‚
- **GLM-4.7 (æ·±åº¦å¼•æ“)**: åå°å¹¶è¡Œé‡æ„ã€‚å½“ MiMo å®ŒæˆåŸºç¡€æ•´ç†æ—¶ï¼ŒGLM-4 å·²ç»ä¸ºä½ å‡†å¤‡å¥½äº†é€»è¾‘æ›´ä¸¥å¯†çš„æ·±åº¦ç‰ˆæœ¬ã€‚
- **ç¬æ—¶åˆ‡æ¢**: é€šè¿‡å½•éŸ³æµ®çª—ä¸€é”®åˆ‡æ¢è§†å›¾ï¼Œå¯¹æ¯”ä¸åŒ AI çš„æ€è€ƒç»“æœã€‚

### âŒ¨ï¸ LCP å¢é‡æ¨¡æ‹Ÿè¾“å…¥
ç‹¬å®¶å®ç°çš„ **LCP (Longest Common Prefix)** ç®—æ³•ï¼Œè®© FlashASR åœ¨å®æ—¶è½¬å†™æ¨¡å¼ä¸‹èƒ½å¤Ÿæ™ºèƒ½åœ°æ¨¡æ‹Ÿé€€æ ¼ä¸è¾“å…¥ã€‚å½“ ASR å¼•æ“ä¿®æ­£å‰é¢çš„è¯æ—¶ï¼Œä½ çš„å…‰æ ‡ä¹Ÿä¼šè‡ªåŠ¨"å›é€€"å¹¶é‡å†™ï¼Œå®ç°çœŸæ­£çš„"æ‰€è¯´å³æ‰€å¾—"ã€‚

### ğŸ§  æ·±åº¦æ‰“ç£¨çš„æç¤ºè¯å·¥ç¨‹ (Prompt Engineering)
å†…ç½®ä¸‰ä¸ªç­‰çº§çš„æ•´ç†æ¨¡å¼ï¼Œé‡‡ç”¨ XML æ ‡ç­¾åŒ– Prompt æ¶æ„ï¼Œç²¾å‡†è¯†åˆ«å£è¯­å™ªå£°ï¼š
- **å¿ å®çº§**: ä»…åšæœ€å°åŒ–æ’ç‰ˆï¼Œä¿ç•™æ¯ä¸€å¤„è¯­æ°”ç»†èŠ‚ã€‚
- **è½»æ¶¦çº§**: è‡ªåŠ¨æ¸…ç†"é‚£ä¸ª"ã€"å°±æ˜¯è¯´"ç­‰åºŸè¯ï¼Œæ™ºèƒ½è¡¥é½æ®‹å¥ã€‚
- **æ·±æ•´çº§**: **é€»è¾‘é‡ç»„**ã€‚å°†å‘æ•£çš„å¯¹è¯è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ä»»åŠ¡åˆ—è¡¨ã€SWOT çŸ©é˜µæˆ–æ­¥éª¤æŒ‡å—ã€‚

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½çŸ©é˜µ

### 1. ä¸¤ç§é‡‡é›†æ¨¡å¼ï¼Œé€‚åº”å…¨åœºæ™¯
- **å®æ—¶æµå¼ (âŒ¥ + Space)**: æé€Ÿæ¨¡å¼ï¼Œé€‚åˆå‘é‚®ä»¶ã€å†™ä»£ç æ³¨é‡Šæˆ–å³æ—¶èŠå¤©ã€‚
- **æ–‡ä»¶é—ªä¼  (âŒ¥ + â†)**: å½•éŸ³é•¿è¾¾ 5 åˆ†é’Ÿï¼Œç»“æŸåé€šè¿‡ HTTP é—ªä¼ ï¼Œé€‚åˆä¼šè®®çºªè¦æˆ–é•¿ç¯‡éšç¬”ã€‚

### 2. å½•éŸ³æŒ‡ç¤ºå™¨ (Recording Indicator)
ä¸€ä¸ªä¼˜é›…çš„ã€åŠé€æ˜çš„åŠ¨æ€æµ®çª—ï¼Œæä¾›å®æ—¶éŸ³é‡æ³¢å½¢åé¦ˆï¼Œå¹¶é›†æˆäº†ï¼š
- **å®æ—¶åˆ‡æ¢**: åœ¨ä¸åŒ Markdown ç­‰çº§é—´è·³è½¬ã€‚
- **Obsidian è”åŠ¨**: ä¸€é”®åŒæ­¥åˆ°ä½ çš„ç¬¬äºŒå¤§è„‘ã€‚
- **æ™ºèƒ½æ¸…ç†**: è‡ªåŠ¨è·³è¿‡é™éŸ³ç‰‡æ®µï¼ŒèŠ‚çœ Tokenã€‚

### 3. æ™ºèƒ½æ–‡æœ¬åå¤„ç†
- **å è¯ä¿æŠ¤**: è¯†åˆ«å¹¶ç§»é™¤ ASR é‡å¤é”™è¯¯ï¼ˆå¦‚"ä½†æ˜¯ä½†æ˜¯"ï¼‰ï¼ŒåŒæ—¶æ™ºèƒ½ä¿ç•™ä¸­æ–‡åˆæ³•å è¯ï¼ˆå¦‚"è€ƒè™‘è€ƒè™‘"ã€"å¹´å¹´å²å²"ï¼‰ã€‚
- **ä¸­è‹±æ··æ’**: è‡ªåŠ¨åœ¨ä¸­æ–‡ä¸è‹±æ–‡/æ•°å­—ä¹‹é—´æ’å…¥ç©ºæ ¼ï¼Œè¿½æ±‚æè‡´çš„è§†è§‰èˆ’é€‚ã€‚

### 4. å¤šè½®ä¼šè¯ç®¡ç†
- æ”¯æŒåœ¨åŒä¸€æ¬¡ä¼šè¯ä¸­å¤šæ¬¡å½•éŸ³ï¼Œè‡ªåŠ¨ç´¯ç§¯æ•´ç†ã€‚
- æä¾›"å…¨æ–‡é‡æ’"åŠŸèƒ½ï¼Œå°†å¤šè½®å½•éŸ³æ•´åˆä¸ºä¸€ä»½å®Œæ•´çš„ Markdown æ–‡æ¡£ã€‚
- è‡ªåŠ¨ç”Ÿæˆä¼šè¯æ ‡é¢˜ï¼Œæ–¹ä¾¿å›æº¯ç®¡ç†ã€‚

### 5. æ–‡æœ¬ä¸Šä¼ å¤„ç† (v4.1+)
- æ”¯æŒç›´æ¥ä»å‰ªè´´æ¿è¯»å–æ–‡æœ¬è¿›è¡Œ Markdown æ•´ç†ã€‚
- æ”¯æŒé€‰æ‹©æœ¬åœ°æ–‡æœ¬æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚
- ä¸è¯­éŸ³è½¬å½•äº«å—åŒæ ·çš„ AI æ•´ç†èƒ½åŠ›ã€‚

---

## ğŸ›  æŠ€æœ¯æ¶æ„é¢„è§ˆ

```mermaid
graph LR
    Mic[Microphone] --> AudioEngine[AVAudioEngine 16kHz/16bit]
    AudioEngine --> VAD[Adaptive VAD é™éŸ³è¿‡æ»¤]
    VAD --> WS[WebSocket Stream]
    WS --> ASR[Dashscope ASR]
    ASR --> LCP[LCP Typer æ¨¡æ‹Ÿè¾“å…¥]

    ASR --> Buffer[Transcript Buffer]
    Buffer --> LLMService[LLMService Actor]

    subgraph "Parallel Processing"
        LLMService --> MiMo[MiMo Flash]
        LLMService --> GLM[GLM-4.7]
    end

    MiMo --> UI[SwiftUI Window]
    GLM --> UI
    UI --> Obsidian[Obsidian Export]
```

---

## ğŸ›¡ éšç§ä¸å®‰å…¨

- **æ•°æ®è¶³è¿¹**: è¯­éŸ³æ•°æ®ä»…æµå‘æ‚¨é…ç½®çš„é˜¿é‡Œäº‘ APIï¼Œä¸ç»è¿‡ä»»ä½•ç¬¬ä¸‰æ–¹ä¸­è½¬æœåŠ¡å™¨ã€‚
- **é€æ˜åº¦**: å¼€æºé¡¹ç›®ï¼Œæ‚¨å¯ä»¥éšæ—¶å®¡è®¡ç½‘ç»œè¯·æ±‚é€»è¾‘ã€‚
- **ç¦»çº¿æ²™ç®±**: æ‰€æœ‰çš„é…ç½®ä¿¡æ¯å’Œä¼šè¯å†å²å‡æœ¬åœ°åŠ å¯†å­˜å‚¨ï¼ˆæˆ–é€šè¿‡ç³»ç»Ÿ Keychainï¼‰ã€‚

---

## ğŸ— å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡å·¥ä½œ
å‰å¾€ [é˜¿é‡Œäº‘ Dashscope](https://dashscope.console.aliyun.com/) è·å–ä½ çš„ API Keyï¼ˆæ–°ç”¨æˆ·æœ‰ä¸°åšçš„å…è´¹é¢åº¦ï¼‰ã€‚

### 2. å®‰è£…
ä¸‹è½½ DMG æ–‡ä»¶ï¼Œæ‹–å…¥åº”ç”¨ç›®å½•ï¼Œç‚¹å‡»å¯åŠ¨ã€‚

### 3. æˆæƒ
FlashASR éœ€è¦ä»¥ä¸‹ä¸‰ä¸ªæƒé™ä»¥å®ç°å®Œæ•´ä½“éªŒï¼š
- **éº¦å…‹é£**: é‡‡é›†å£°éŸ³ã€‚
- **è¾…åŠ©åŠŸèƒ½**: å°†æ–‡å­—æ¨¡æ‹Ÿé”®å…¥åˆ°å…¶ä»– Appã€‚
- **è¾“å…¥ç›‘å¬**: å…¨å±€å¿«æ·é”®å“åº”ã€‚

---

## ğŸ“¦ æ„å»ºä¸è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰æé«˜ç”Ÿäº§åŠ›çš„ Pull Requestï¼

```bash
# æ„å»º App Bundle
./scripts/build_app.sh

# å®‰è£…åˆ° Applications æ–‡ä»¶å¤¹
./scripts/install_app.sh

# å¸è½½
./scripts/uninstall_app.sh

# æ‰“åŒ…å‘å¸ƒç‰ˆ (DMG/ZIP)
./scripts/package_release.sh
```

**å¼€å‘æ ˆ**:
- **UI**: SwiftUI
- **é€»è¾‘**: Swift 5.9 (Swift Concurrency)
- **åº•å±‚**: AVFoundation, Carbon API, CoreGraphics

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
FlashASR/
â”œâ”€â”€ Sources/                    # Swift æºä»£ç 
â”‚   â”œâ”€â”€ FlashASRApp.swift       # åº”ç”¨å…¥å£ (@main)
â”‚   â”œâ”€â”€ AppDelegate.swift        # NSApplicationDelegate
â”‚   â”œâ”€â”€ AppController.swift      # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ AppStatePublisher.swift  # UI çŠ¶æ€å‘å¸ƒå™¨
â”‚   â”œâ”€â”€ SettingsManager.swift    # ç”¨æˆ·è®¾ç½®ç®¡ç†
â”‚   â”œâ”€â”€ AudioCapture.swift       # éŸ³é¢‘é‡‡é›†
â”‚   â”œâ”€â”€ ASRWebSocketClient.swift # å®æ—¶ ASR å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ FileASRStreamClient.swift # æ–‡ä»¶ ASR å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ LLMService.swift         # LLM ç»Ÿä¸€æœåŠ¡
â”‚   â”œâ”€â”€ MiMoClient.swift         # MiMo API å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ MarkdownPrompts.swift    # æç¤ºè¯æ¨¡æ¿
â”‚   â”œâ”€â”€ TranscriptBuffer.swift   # è½¬å†™ç¼“å†²åŒº
â”‚   â”œâ”€â”€ RealtimeTyper.swift      # é”®ç›˜æ¨¡æ‹Ÿè¾“å…¥
â”‚   â”œâ”€â”€ TextPostProcessor.swift  # æ–‡æœ¬åå¤„ç†
â”‚   â”œâ”€â”€ GlobalKeyTap.swift       # å…¨å±€å¿«æ·é”®ç›‘å¬
â”‚   â”œâ”€â”€ RecordingIndicator.swift # å½•éŸ³æŒ‡ç¤ºå™¨
â”‚   â”œâ”€â”€ SessionModel.swift       # ä¼šè¯æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ SessionManager.swift     # ä¼šè¯ç®¡ç†å™¨
â”‚   â””â”€â”€ *SettingsView.swift      # å„è®¾ç½®é¢æ¿
â”œâ”€â”€ scripts/                    # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build_app.sh            # ç¼–è¯‘åº”ç”¨
â”‚   â”œâ”€â”€ package_release.sh      # æ‰“åŒ…å‘å¸ƒ
â”‚   â””â”€â”€ install_app.sh          # å®‰è£…åº”ç”¨
â”œâ”€â”€ assets/                     # èµ„æºæ–‡ä»¶
â”‚   â””â”€â”€ app_icon_source.png     # åº”ç”¨å›¾æ ‡
â”œâ”€â”€ CLAUDE.md                   # Claude Code æŒ‡å¯¼æ–‡æ¡£
â””â”€â”€ README.md                   # æœ¬æ–‡æ¡£
```

---

## ğŸ”‘ æ ¸å¿ƒå¸¸é‡

**éŸ³é¢‘å‚æ•°** (AudioCapture.swift):
- é‡‡æ ·ç‡: `16,000` Hz
- å£°é“: `1` (å•å£°é“)
- å¸§é•¿: `20` ms (640 å­—èŠ‚)
- é™éŸ³é˜ˆå€¼: `220`

**è¶…æ—¶é…ç½®**:
- å®æ—¶ finalize: `2` ç§’
- æ–‡ä»¶ ASR è¶…æ—¶: `90` ç§’
- æœ€å¤§æ–‡ä»¶å½•éŸ³: `300` ç§’ (5 åˆ†é’Ÿ)
- è‡ªåŠ¨åœæ­¢å»¶è¿Ÿ: `2.2` ç§’ (å¯é…ç½®)

---

## ğŸ”¬ ASR å·¥ä½œæµè¯¦è§£

FlashASR çš„æ ¸å¿ƒç«äº‰åŠ›åœ¨äºä¸¤å¥—ç²¾å¿ƒè®¾è®¡çš„é˜¿é‡Œäº‘ Dashscope ASR å·¥ä½œæµï¼š

- **å®æ—¶æµå¼æ¨¡å¼ (âŒ¥ + Space)**: åŸºäº WebSocket çš„è¶…ä½å»¶è¿Ÿæµå¼è¯†åˆ«ï¼Œè¾¹è¯´è¾¹è½¬ï¼Œé¦–å­—å»¶è¿Ÿ < 100ms
- **æ–‡ä»¶é—ªä¼ æ¨¡å¼ (âŒ¥ + â†)**: åŸºäº HTTP çš„å…¨é‡éŸ³é¢‘åˆ†æï¼Œæ”¯æŒ 5 åˆ†é’Ÿé•¿å½•éŸ³ï¼Œç²¾åº¦æ›´é«˜

è¯¦ç»†çš„æŠ€æœ¯æ¶æ„ã€åè®®è§„èŒƒã€é”™è¯¯å¤„ç†æœºåˆ¶è¯·å‚é˜…ï¼š[**ASR å·¥ä½œæµè¯¦è§£**](docs/ASR_WORKFLOWS.md)

---

## ğŸ“‹ ç‰ˆæœ¬å†å²

### v4.5.0 (æœ€æ–°)
- æ·»åŠ æƒé™ä¿¡ä»»è¦†ç›–æ¨¡å¼æ”¯æŒ
- ä¼˜åŒ– LLM æœåŠ¡ç»Ÿä¸€ç®¡ç†
- å¢å¼ºåŒå¼•æ“ååŒå¤„ç†èƒ½åŠ›

### v4.1.0
- æ·»åŠ å¤š LLM æä¾›å•†æ”¯æŒ (MiMo / GLM)
- æ”¯æŒæ–‡æœ¬ä¸Šä¼ å¤„ç†åŠŸèƒ½
- æ”¹è¿›ä¼šè¯ç®¡ç†å’Œå¤šçº§ Markdown æ•´ç†

### v4.0.0
- å¼•å…¥åŒå¼•æ“ååŒæ¶æ„
- å®ç°ä¼šè¯ç®¡ç†å’Œå¤šè½®å½•éŸ³
- æ·»åŠ  Obsidian é›†æˆ

---

<div align="center">

**FlashASR** Â· è®©æ€è€ƒä¸å†è¢«é”®ç›˜æŸç¼š

[â­ ç»™é¡¹ç›®ç‚¹ä¸ªèµ](https://github.com/BRSAMAyu/flash_ASR) Â· [ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/BRSAMAyu/flash_ASR/issues)

</div>
